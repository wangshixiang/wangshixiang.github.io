
[TOC]

#### 

## 第五章 新闻资讯app系统实现

### 5.1 主页

主页放置了各类新闻的热门聚合，涉及的功能包括jquery ajax获取新闻源服务器数据，数据和样式的渲染，代码示例以及最终实现效果如下：

- 代码

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=1080,target-densitydpi=340,user-scalable=no" />
<meta name="full-screen" content="yes">
<title></title>
<link rel="stylesheet" href="css/ws_style.css">
<link rel="stylesheet" href="css/swiper.css">
<script src="js/jquery-1.8.3.js"></script>
<script src="js/swiper.js"></script>
</head>
<style>
	.notice{height: 100px;line-height: 100px;color:red;font-size:40px;display: none;}
	.notice a{color:#666;font-size:40px;}
	.notice a:hover{color:#ff4951;}
</style>
<body>
	<iframe src="public_title.html" frameborder="0"></iframe>
	
	<div class="swiper-container banner">
		<div class="swiper-wrapper"></div>
		<div class="swiper-pagination"></div>
	</div>

	<div class="notice">
		<marquee behavior="scroll" direction="left" scrollamount="20"></marquee>
	</div>
	<div class="index_main"></div>
	<div class="loading"><img src="images/loading.gif" alt=""></div>
	<div class="ajax_btn">点击加载更多</div>

<script>
	
	
	var page = 1;
	$('.loading').show();
	$('.ajax_btn').hide();
	$.ajax({
		url:'http://www.tngou.net/api/top/list',
		type:'get',
		data:{'page':'1','rows':'30'},
		dataType:'jsonp',	
		success:function(data){
			banner(data);
		}
	});

	$('.ajax_btn').click(ajax_data);
	function ajax_data(){
		$('.loading').show();
		$('.ajax_btn').hide();
		page++;
		$.ajax({
			url:'http://www.tngou.net/api/top/list',
			type:'get',
			data:{'page':page,'rows':'30'},
			dataType:'jsonp',	
			success:function(data){
				text(data);
			}
		});
	}

	function time_long(time){
		var new_time = new Date();
		var long_time = new Date(time);
	    var r = 0; 
	    
	    if (new_time.getDate() > long_time.getDate()) { 
	    	r = (new_time.getDate() - long_time.getDate()); 
	    	return r + "天前"; 
	    }
	    if (new_time.getHours() > long_time.getHours()) { 
	    	r = (new_time.getHours() - long_time.getHours()); 
	    	return r + "个小时前"; 
	    }
	    if (new_time.getMinutes() > long_time.getMinutes()) { 
	    	r = (new_time.getMinutes() - long_time.getMinutes()); 
		    return r + "分钟前"; 
	    } 
	    	return "刚刚"; 
	};

	function banner(e){
		for(var i=0;i<6;i++){
			if(e.tngou[i].img!='/top/default.jpg'){
				$('.banner .swiper-wrapper').append('<div class="swiper-slide"><a href="news_show.html#'+ e.tngou[i].id +'"><img src="http://tnfs.tngou.net/image/'+ e.tngou[i].img +'" alt=""></a><div class="banner_text">'+ e.tngou[i].keywords +'</div></div>');
			}
		}

		$.ajax({
			url:'data.json',
			type:'get',
			dataType:'json',
			success:function(data){
				$('.notice marquee').html('<a href="gg_main.html">'+ data.title+'&nbsp;&nbsp;&nbsp;&nbsp;'+data.date +'</a>');
				if(data.open=='true' && data.title!='' && new Date().getTime()>new Date(data.start).getTime() && new Date().getTime()<new Date(data.end).getTime()){
					$('.notice').show();
				}
			}
		});
		
		var swiper = new Swiper('.swiper-container', {
		    pagination: '.swiper-pagination',
		    paginationClickable: true,
		});
		text(e);
	};

	function text(t){
		for(var i=6;i<30;i++){
			if(t.tngou[i].img!='/top/default.jpg'){
				var time = t.tngou[i].time;
				var row_html = '<div class="index_row"><div class="container"><a href="news_show.html#'+ t.tngou[i].id +'"><div class="left"><img src="http://tnfs.tngou.net/image/'+ t.tngou[i].img +'" alt=""></div><div class="right"><h2>'+ t.tngou[i].title +'</h2><div class="time"><div class="time_left">'+ t.tngou[i].fromname +'</div><div class="time_right">'+ time_long(time) +'</div></div></div><div class="clearfix"></div></a></div></div>'
				$('.index_main').append(row_html);
			}
		}
		$('.loading').hide();
		$('.ajax_btn').show();
	};
	

</script>
</body>
</html>


```

- 效果

  ​


### 5.2 新闻详情页

新闻详情页是用户阅读新闻停留时间最长的页面。本页面将提供新闻标题，新闻图片，新闻内容，新闻发布时间等功能，使用ajax获取远程数据库的数据。并提供展示。示例代码及效果图如下：

代码：

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=1080,target-densitydpi=340,user-scalable=no" />
<title>随阅新闻网</title>
<link rel="stylesheet" href="css/ws_style.css">
<script src="js/jquery-1.8.3.js"></script>
</head>
<body>
	<div class="title">
		<a href="javascript:history.back(-1)"><img src="images/left.png" alt=""></a>
		详情
	</div>
	<h1 class="title_h1"></h1>
	<div class="news_time">
		<span class="left"></span>
		<span class="right"></span>
	</div>
	<div class="container">
		<div class="news_text"></div>
		<div class="text_ul">
			<h2>相关阅读:</h2>
			<ul class="container"></ul>
		</div>
	</div>
<script>
	



	var pro_id = window.location.hash.substring(1);
	$.ajax({
		url:'http://www.tngou.net/api/top/show',
		data:{'id':pro_id},
		type:'get',
		dataType:'jsonp',	
		success:function(data){
			news_text(data);
		}
	});

	function news_text(e){
		$('.title_h1').text(e.title)
		$('.news_text').html(e.message);
		var time = new Date(e.time);
		$('span.left').html(time.getFullYear()+'-'+(time.getMonth()+1)+'-'+time.getDate()+' 发布');
		$('span.right').html(e.count+'浏览');
		if($('.news_text img').length<1){
			$('.news_text').prepend('<img src="http://tnfs.tngou.net/image/'+ e.img +'" alt="">');
		}

		$.ajax({
			url:'http://www.tngou.net/api/top/list',
			type:'get',
			data:{'id':'6','rows':'6','page':parseInt(Math.random()*(20-1)+1)},
			dataType:'jsonp',	
			success:function(data){
				xg(data);
			}
		});

		function xg(t){
			for(var i=0;i<6;i++){
				if(t.tngou[i].img!='/top/default.jpg'){
					$('ul.container').append('<li><a href="xiangguan.html#'+ t.tngou[i].id +'">'+ t.tngou[i].title +'</a></li>');
				}
			}
		}
	};
</script>
</body>
</html>


```



### 5.3 相关新闻功能

为方便用户获取相关新闻，设置了相关新闻功能，示例代码及最终效果图如下：

示例代码：

```html
function xg(t){
			for(var i=0;i<6;i++){
				if(t.tngou[i].img!='/top/default.jpg'){
					$('ul.container').append('<li><a href="xiangguan.html#'+ t.tngou[i].id +'">'+ t.tngou[i].title +'</a></li>');
				}
			}
		}
```



### 5.4 民生新闻专题

民生新闻专题主要提供了民生新闻的列表展示页面，示例代码及实际效果如下：

代码：

```html

<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=1080,target-densitydpi=340,user-scalable=no" />
<meta name="full-screen" content="yes">
<title></title>
<link rel="stylesheet" href="css/ws_style.css">
<link rel="stylesheet" href="css/swiper.css">
<script src="js/jquery-1.8.3.js"></script>
<script src="js/swiper.js"></script>
</head>
<body>
	<iframe src="public_title.html" frameborder="0"></iframe>
	
	<div class="index_main"></div>
	<div class="loading"><img src="images/loading.gif" alt=""></div>
	<div class="ajax_btn">点击加载更多</div>

<script>
	
	var id = window.location.hash.substring(1);
	var page = 1;
	$('.loading').show();
	$('.ajax_btn').hide();
	$.ajax({
		url:'http://www.tngou.net/api/top/list',
		type:'get',
		data:{'page':'1','rows':'20','id':id},
		dataType:'jsonp',	
		success:function(data){
			text(data);
		}
	});

	$('.ajax_btn').click(ajax_data);
	function ajax_data(){
		$('.loading').show();
		$('.ajax_btn').hide();
		page++;
		$.ajax({
			url:'http://www.tngou.net/api/top/list',
			type:'get',
			data:{'page':page,'rows':'20','id':id},
			dataType:'jsonp',	
			success:function(data){
				text(data);
			}
		});
	}

	function time_long(time){
		var new_time = new Date();
		var long_time = new Date(time);
	    var r = 0; 
	    
	    if (new_time.getDate() > long_time.getDate()) { 
	    	r = (new_time.getDate() - long_time.getDate()); 
	    	return r + "天前"; 
	    }
	    if (new_time.getHours() > long_time.getHours()) { 
	    	r = (new_time.getHours() - long_time.getHours()); 
	    	return r + "个小时前"; 
	    }
	    if (new_time.getMinutes() > long_time.getMinutes()) { 
	    	r = (new_time.getMinutes() - long_time.getMinutes()); 
		    return r + "分钟前"; 
	    } 
	    	return "刚刚"; 
	};

	function text(t){
		for(var i=0;i<20;i++){
			if(t.tngou[i].img!='/top/default.jpg'){
				var time = t.tngou[i].time;
				var row_html = '<div class="index_row"><div class="container"><a href="news_show.html#'+ t.tngou[i].id +'"><div class="left"><img src="http://tnfs.tngou.net/image/'+ t.tngou[i].img +'" alt=""></div><div class="right"><h2>'+ t.tngou[i].title +'</h2><div class="time"><div class="time_left">'+ t.tngou[i].fromname +'</div><div class="time_right">'+ time_long(time) +'</div></div></div><div class="clearfix"></div></a></div></div>'
				$('.index_main').append(row_html);
			}
		}
		$('.loading').hide();
		$('.ajax_btn').show();
	};
	

</script>
</body>
</html>


```



### 5.5 体育新闻专题

体育新闻专题页提供了体育新闻列表的展示功能，代码及效果图如下：

```html

<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=1080,target-densitydpi=340,user-scalable=no" />
<meta name="full-screen" content="yes">
<title></title>
<link rel="stylesheet" href="css/ws_style.css">
<link rel="stylesheet" href="css/swiper.css">
<script src="js/jquery-1.8.3.js"></script>
<script src="js/swiper.js"></script>
</head>
<body>
	<iframe src="public_title.html" frameborder="0"></iframe>
	
	<div class="index_main"></div>
	<div class="loading"><img src="images/loading.gif" alt=""></div>
	<div class="ajax_btn">点击加载更多</div>

<script>
	
	var id = window.location.hash.substring(1);
	var page = 1;
	$('.loading').show();
	$('.ajax_btn').hide();
	$.ajax({
		url:'http://www.tngou.net/api/top/list',
		type:'get',
		data:{'page':'1','rows':'20','id':id},
		dataType:'jsonp',	
		success:function(data){
			text(data);
		}
	});

	$('.ajax_btn').click(ajax_data);
	function ajax_data(){
		$('.loading').show();
		$('.ajax_btn').hide();
		page++;
		$.ajax({
			url:'http://www.tngou.net/api/top/list',
			type:'get',
			data:{'page':page,'rows':'20','id':id},
			dataType:'jsonp',	
			success:function(data){
				text(data);
			}
		});
	}

	function time_long(time){
		var new_time = new Date();
		var long_time = new Date(time);
	    var r = 0; 
	    
	    if (new_time.getDate() > long_time.getDate()) { 
	    	r = (new_time.getDate() - long_time.getDate()); 
	    	return r + "天前"; 
	    }
	    if (new_time.getHours() > long_time.getHours()) { 
	    	r = (new_time.getHours() - long_time.getHours()); 
	    	return r + "个小时前"; 
	    }
	    if (new_time.getMinutes() > long_time.getMinutes()) { 
	    	r = (new_time.getMinutes() - long_time.getMinutes()); 
		    return r + "分钟前"; 
	    } 
	    	return "刚刚"; 
	};

	function text(t){
		for(var i=0;i<20;i++){
			if(t.tngou[i].img!='/top/default.jpg'){
				var time = t.tngou[i].time;
				var row_html = '<div class="index_row"><div class="container"><a href="news_show.html#'+ t.tngou[i].id +'"><div class="left"><img src="http://tnfs.tngou.net/image/'+ t.tngou[i].img +'" alt=""></div><div class="right"><h2>'+ t.tngou[i].title +'</h2><div class="time"><div class="time_left">'+ t.tngou[i].fromname +'</div><div class="time_right">'+ time_long(time) +'</div></div></div><div class="clearfix"></div></a></div></div>'
				$('.index_main').append(row_html);
			}
		}
		$('.loading').hide();
		$('.ajax_btn').show();
	};
	

</script>
</body>
</html>


```

5.6 其他新闻专题

其他新闻专题使用了相似的技术，部分代码示例如下：

```html

<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=1080,target-densitydpi=340,user-scalable=no" />
<meta name="full-screen" content="yes">
<title></title>
<link rel="stylesheet" href="css/ws_style.css">
<link rel="stylesheet" href="css/swiper.css">
<script src="js/jquery-1.8.3.js"></script>
<script src="js/swiper.js"></script>
</head>
<body>
	<iframe src="public_title.html" frameborder="0"></iframe>
	
	<div class="index_main"></div>
	<div class="loading"><img src="images/loading.gif" alt=""></div>
	<div class="ajax_btn">点击加载更多</div>

<script>
	
	var id = window.location.hash.substring(1);
	var page = 1;
	$('.loading').show();
	$('.ajax_btn').hide();
	$.ajax({
		url:'http://www.tngou.net/api/top/list',
		type:'get',
		data:{'page':'1','rows':'20','id':id},
		dataType:'jsonp',	
		success:function(data){
			text(data);
		}
	});

	$('.ajax_btn').click(ajax_data);
	function ajax_data(){
		$('.loading').show();
		$('.ajax_btn').hide();
		page++;
		$.ajax({
			url:'http://www.tngou.net/api/top/list',
			type:'get',
			data:{'page':page,'rows':'20','id':id},
			dataType:'jsonp',	
			success:function(data){
				text(data);
			}
		});
	}

	function time_long(time){
		var new_time = new Date();
		var long_time = new Date(time);
	    var r = 0; 
	    
	    if (new_time.getDate() > long_time.getDate()) { 
	    	r = (new_time.getDate() - long_time.getDate()); 
	    	return r + "天前"; 
	    }
	    if (new_time.getHours() > long_time.getHours()) { 
	    	r = (new_time.getHours() - long_time.getHours()); 
	    	return r + "个小时前"; 
	    }
	    if (new_time.getMinutes() > long_time.getMinutes()) { 
	    	r = (new_time.getMinutes() - long_time.getMinutes()); 
		    return r + "分钟前"; 
	    } 
	    	return "刚刚"; 
	};

	function text(t){
		for(var i=0;i<20;i++){
			if(t.tngou[i].img!='/top/default.jpg'){
				var time = t.tngou[i].time;
				var row_html = '<div class="index_row"><div class="container"><a href="news_show.html#'+ t.tngou[i].id +'"><div class="left"><img src="http://tnfs.tngou.net/image/'+ t.tngou[i].img +'" alt=""></div><div class="right"><h2>'+ t.tngou[i].title +'</h2><div class="time"><div class="time_left">'+ t.tngou[i].fromname +'</div><div class="time_right">'+ time_long(time) +'</div></div></div><div class="clearfix"></div></a></div></div>'
				$('.index_main').append(row_html);
			}
		}
		$('.loading').hide();
		$('.ajax_btn').show();
	};
	

</script>
</body>
</html>


```



## 

